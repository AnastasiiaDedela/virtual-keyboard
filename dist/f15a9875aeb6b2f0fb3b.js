import{KEY_CODES,KEYS_ENG,KEYS_ENG_CAPS,KEYS_ENG_SHIFT,KEYS_ENG_CAPS_SHIFT,KEYS_RU,KEYS_RU_SHIFT,KEYS_RU_CAPS,KEYS_RU_CAPS_SHIFT}from"./keys.js";import"./style.css";import{addKeyupKeydownEvents,addAnimationEvents,handleBackspace,handleDel}from"./utils";const specialKeys=["Backspace","Del","Shift","Enter","Caps Lock","Tab","Space","Alt","Ctrl","Win"],body=document.querySelector("body"),keyboardContainer=document.createElement("div");keyboardContainer.classList.add("keyboard");let lang="eng";const capslockActive={value:!1},setState=(e,t)=>{e.value=t};function deleteRows(){document.querySelectorAll(".row").forEach((e=>{e.remove()}))}const drawKeyboard=function(e){let t=[];return e.forEach((e=>{const a=document.createElement("div");a.classList.add("row"),e.forEach((e=>{const n=document.createElement("div");n.classList.add("key"),n.textContent=e,"Backspace"===e?n.classList.add("backspace"):"Del"===e?n.classList.add("delete"):"Shift"===e?n.classList.add("shift"):"Enter"===e?n.classList.add("enter"):"Caps Lock"===e?n.classList.add("caps-lock"):"Tab"===e?n.classList.add("tab"):"Space"===e?n.classList.add("space"):"/"===e?n.classList.add("backslash"):"â†‘"===e?n.classList.add("arrow-up"):"Win"===e?n.classList.add("windows"):"Ctrl"===e&&n.classList.add("ctrl"),a.appendChild(n),t.push(n)})),keyboardContainer.appendChild(a)})),t},switchLang=(e,t)=>{deleteRows();let a=[];return"eng"===e&&!1===t?a=drawKeyboard(KEYS_ENG):"eng"===e&&!0===t?a=drawKeyboard(KEYS_ENG_CAPS):"ru"===e&&!1===t?a=drawKeyboard(KEYS_RU):"ru"===e&&!0===t&&(a=drawKeyboard(KEYS_RU_CAPS)),document.body.appendChild(keyboardContainer),a};function addOnclickEvents(e,t){t.forEach((t=>{specialKeys.includes(t.textContent)?"Space"===t.textContent?t.addEventListener("click",(()=>{e.value+=" ",e.focus()})):"Enter"===t.textContent?t.addEventListener("click",(()=>{e.value+="\n",e.focus()})):"Tab"===t.textContent?t.addEventListener("click",(()=>{e.value+="    ",e.focus()})):"Caps Lock"===t.textContent?t.addEventListener("click",(()=>{setState(capslockActive,!capslockActive.value);const t=switchLang(lang,capslockActive.value);addKeyupKeydownEvents(t),addAnimationEvents(t),addOnclickEvents(e,t)})):"Backspace"===t.textContent?(t.addEventListener("click",handleBackspace),window.addEventListener("keydown",(t=>{"Backspace"===t.key&&handleBackspace(e)}))):"Del"===t.textContent&&(t.addEventListener("click",handleDel),window.addEventListener("keydown",(t=>{"Delete"===t.key&&handleDel(e)}))):t.addEventListener("click",(()=>{const a=t.textContent;e.value+=a,e.focus()}))}))}const keys=switchLang(lang,capslockActive.value),textarea=document.createElement("textarea");body.insertBefore(textarea,keyboardContainer),textarea.classList.add("text-area"),addKeyupKeydownEvents(keys),addAnimationEvents(keys),addOnclickEvents(textarea,keys),document.addEventListener("keydown",(e=>{if("CapsLock"===e.key){setState(capslockActive,!capslockActive.value);const e=switchLang(lang,capslockActive.value);e.forEach((e=>{"Caps Lock"===e.textContent&&e.classList.add("highlighted")})),addKeyupKeydownEvents(e),addAnimationEvents(e),addOnclickEvents(textarea,e)}})),document.addEventListener("keydown",(e=>{if(console.log(e),!0===e.shiftKey&&!0===e.altKey)if(setState(capslockActive,capslockActive.value),"eng"===lang){lang="ru";const e=switchLang(lang,capslockActive.value);addKeyupKeydownEvents(e),addAnimationEvents(e),addOnclickEvents(textarea,e)}else if("ru"===lang){lang="eng";const e=switchLang(lang,capslockActive.value);addKeyupKeydownEvents(e),addAnimationEvents(e),addOnclickEvents(textarea,e)}}));